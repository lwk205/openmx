copied from the original work (openmx3.8.3)
